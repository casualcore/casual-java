/*
 * Copyright (c) 2017 - 2018, The casual project. All rights reserved.
 *
 * This software is licensed under the MIT license, https://opensource.org/licenses/MIT
 */

//-*- coding: utf-8 -*-
plugins {
    id 'java'
    id 'jacoco'
    id 'groovy'
}

defaultTasks 'build'

group = 'se.laz.casual'

configurations {
    resourceAdapter
}

dependencies {
    provided project(':casual:casual-api')
    implementation project(':casual:casual-inbound-api')
    implementation project(':casual:casual-internal')
    implementation project(':casual:casual-network')
    implementation project(':casual:casual-network-protocol')
    implementation project(':casual:casual-inbound')
    provided libs.netty
    provided libs.javaee_api
    resourceAdapter project(':casual:casual-internal')
    resourceAdapter project(':casual:casual-network')
    resourceAdapter project(':casual:casual-network-protocol')
    resourceAdapter project(':casual:casual-inbound-api')

    testCompile libs.hamcrest_all
    // for spock
    testCompile libs.groovy_all
    testCompile libs.spock_core
    testCompile libs.cglib_nodep
    testCompile libs.objenesis

    //Integration test.
    integrationCompile project(':casual:casual-fielded-annotations')
    integrationCompile files('../../../casual-java-testapp/test-api/build/libs/test-api.jar')
    integrationCompile libs.commons_io

    integrationRuntime libs.gson
}

task rar(type: Jar) {
    manifest {
        attributes 'Implementation-Title': 'Casual Resource Adapter with XA', 'Implementation-Version': '1.0', 'Specification-Version': '1.0'
    }
    extension = 'rar'
    into('') {
        from jar
    }
    into('') {
        from configurations.resourceAdapter
    }
    into('') {
        from sourceSets.main.resources
    }
}

artifacts.add( "resourceAdapter", rar )
